<!DOCTYPE html>
<html>
<head>
    <title>Добавление данных в текстовый файл</title>
</head>
<body>
    <input type="file" id="fileInput">
    <div id="additionalFields">
        <textarea rows="5" cols="40" class="additionalData">Дополнительные данные, которые будут добавлены в файл.</textarea><br>
        <textarea cols="30" rows="10" class="additionalData"></textarea>
    </div>
    <button onclick="appendToFile()">Добавить в файл</button>

    <script>
        let selectedFile = null;

        document.getElementById('fileInput').addEventListener('change', function(event) {
            selectedFile = event.target.files[0];
        });

        function appendToFile() {
            if (selectedFile) {
                const fileReader = new FileReader();
                const additionalFields = document.getElementsByClassName('additionalData');
                let finalContent = '';

                fileReader.onload = function(event) {
                    const existingContent = event.target.result;
                    finalContent = existingContent;

                    for (let i = 0; i < additionalFields.length; i++) {
                        finalContent += ',' + additionalFields[i].value+'\n';
                    }

                    const blob = new Blob([finalContent], { type: 'text/plain' });
                    const a = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    a.href = url;
                    a.download = 'updated_file.txt';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                };

                fileReader.readAsText(selectedFile);
            } else {
                console.error('Выберите файл для добавления данных.');
            }
        }
    </script>
</body>
</html>
